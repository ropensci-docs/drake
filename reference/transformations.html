<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In drake_plan(), you can define whole batches
of targets with transformations such as
map(), split(), cross(), and combine()."><title>Transformations in drake_plan().  — transformations • drake</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transformations in drake_plan().  — transformations"><meta property="og:description" content="In drake_plan(), you can define whole batches
of targets with transformations such as
map(), split(), cross(), and combine()."><meta property="og:image" content="https://docs.ropensci.org/drake/logo.svg"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">drake</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">7.13.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://books.ropensci.org/drake/">Full manual</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://books.ropensci.org/drake/faq.html">FAQ</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/drake">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Transformations in <code>drake_plan()</code>. <a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/drake/blob/HEAD/R/transform_plan.R" class="external-link"><code>R/transform_plan.R</code></a></small>
      <div class="d-none name"><code>transformations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In <code><a href="drake_plan.html">drake_plan()</a></code>, you can define whole batches
of targets with transformations such as
<code>map()</code>, <code>split()</code>, <code>cross()</code>, and <code>combine()</code>.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>...</dt>
<dd><p>Grouping variables. New grouping variables must be
supplied with their names and values, existing grouping variables
can be given as symbols without any values assigned.
For dynamic branching, the entries in <code>...</code> must be unnamed symbols
with no values supplied, and they must be the names of targets.</p></dd>


<dt>.data</dt>
<dd><p>A data frame of new grouping variables with
grouping variable names as column names and values as elements.</p></dd>


<dt>.names</dt>
<dd><p>Literal character vector of names for the targets.
Must be the same length as the targets generated.</p></dd>


<dt>.id</dt>
<dd><p>Symbol or vector of symbols naming grouping variables
to incorporate into target names. Useful for creating short target
names. Set <code>.id = FALSE</code> to use integer indices as target name suffixes.</p></dd>


<dt>.tag_in</dt>
<dd><p>A symbol or vector of symbols. Tags assign targets
to grouping variables. Use <code>.tag_in</code> to assign <em>untransformed</em>
targets to grouping variables.</p></dd>


<dt>.tag_out</dt>
<dd><p>Just like <code>.tag_in</code>, except that <code>.tag_out</code>
assigns <em>transformed</em> targets to grouping variables.</p></dd>


<dt>slice</dt>
<dd><p>Number of slices into which <code>split()</code> partitions the data.</p></dd>


<dt>margin</dt>
<dd><p>Which margin to take the slices in <code>split()</code>. Same meaning
as the <code>MARGIN</code> argument of <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code>.</p></dd>


<dt>drop</dt>
<dd><p>Logical, whether to drop a dimension if its length is 1.
Same meaning as <code>mtcars[, 1L, drop = TRUE]</code> versus
<code>mtcars[, 1L, drop = TRUE]</code>.</p></dd>


<dt>.by</dt>
<dd><p>Symbol or vector of symbols of grouping variables.
<code>combine()</code> aggregates/groups targets by the grouping variables in <code>.by</code>.
For dynamic branching, <code>.by</code> can only take one variable at a time,
and that variable must be a vector. Ideally, it should take
little space in memory.</p></dd>


<dt>.trace</dt>
<dd><p>Symbol or vector of symbols for the dynamic trace.
The dynamic trace allows you to keep track of the values of
dynamic dependencies are associated with individual sub-targets.
For <code>combine()</code>, <code>.trace</code> must either be empty or the same as the
variable given for <code>.by</code>.
See <code><a href="get_trace.html">get_trace()</a></code> and <code><a href="read_trace.html">read_trace()</a></code> for examples and other details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For details, see
<code>https://books.ropensci.org/drake/plans.html#large-plans</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a></h2>
    

<p><code>drake</code> has special syntax for generating large plans.
Your code will look something like
<code>drake_plan(y = target(f(x), transform = map(x = c(1, 2, 3)))</code>
You can read about this interface at
<code>https://books.ropensci.org/drake/plans.html#large-plans</code>. # nolint</p>
    </div>
    <div class="section level2">
    <h2 id="static-branching">Static branching<a class="anchor" aria-label="anchor" href="#static-branching"></a></h2>
    

<p>In static branching, you define batches of targets
based on information you know in advance.
Overall usage looks like
<code>drake_plan(&lt;x&gt; = target(&lt;...&gt;, transform = &lt;call&gt;)</code>,
where</p><ul><li><p><code>&lt;x&gt;</code> is the name of the target or group of targets.</p></li>
<li><p><code>&lt;...&gt;</code> is optional arguments to <code><a href="target.html">target()</a></code>.</p></li>
<li><p><code>&lt;call&gt;</code> is a call to one of the transformation functions.</p></li>
</ul><p>Transformation function usage:</p><ul><li><p><code>map(..., .data, .names, .id, .tag_in, .tag_out)</code></p></li>
<li><p><code>split(..., slices, margin = 1L, drop = FALSE, .names, .tag_in, .tag_out)</code> # nolint</p></li>
<li><p><code>cross(..., .data, .names, .id, .tag_in, .tag_out)</code></p></li>
<li><p><code>combine(..., .by, .names, .id, .tag_in, .tag_out)</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="dynamic-branching">Dynamic branching<a class="anchor" aria-label="anchor" href="#dynamic-branching"></a></h2>
    

<ul><li><p><code>map(..., .trace)</code></p></li>
<li><p><code>cross(..., .trace)</code></p></li>
<li><p><code>group(..., .by, .trace)</code></p></li>
</ul><p><code>map()</code> and <code>cross()</code> create dynamic sub-targets from the variables
supplied to the dots. As with static branching, the variables
supplied to <code>map()</code> must all have equal length.
<code>group(f(data), .by = x)</code> makes new dynamic
sub-targets from <code>data</code>. Here, <code>data</code> can be either static or dynamic.
If <code>data</code> is dynamic, <code>group()</code> aggregates existing sub-targets.
If <code>data</code> is static, <code>group()</code> splits <code>data</code> into multiple
subsets based on the groupings from <code>.by</code>.</p>
<p>Differences from static branching:</p><ul><li><p><code>...</code> must contain <em>unnamed</em> symbols with no values supplied,
and they must be the names of targets.</p></li>
<li><p>Arguments <code>.id</code>, <code>.tag_in</code>, and <code>.tag_out</code> no longer apply.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Static branching</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glm"</span>, <span class="st">"hierarchical"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="drake_plan.html">drake_plan</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">get_data</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simulated"</span>, <span class="st">"survey"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  analysis <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">analyze_data</span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">cross</span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">models</span>, .id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  summary <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">summarize_analysis</span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">analysis</span>, .id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">summary</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">combine</span><span class="op">(</span><span class="va">summary</span>, .by <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plan</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 12 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    target                          command                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;expr_lst&gt;</span>                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> analysis_simulated_glm          analyze_data(data_simulated, "glm")         …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> analysis_simulated_hierarchical analyze_data(data_simulated, "hierarchical")…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> analysis_survey_glm             analyze_data(data_survey, "glm")            …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> analysis_survey_hierarchical    analyze_data(data_survey, "hierarchical")   …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> data_simulated                  get_data("simulated")                       …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> data_survey                     get_data("survey")                          …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> results_data_simulated          bind_rows(summary_simulated_glm, summary_sim…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> results_data_survey             bind_rows(summary_survey_glm, summary_survey…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> summary_simulated_glm           summarize_analysis(analysis_simulated_glm)  …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> summary_simulated_hierarchical  summarize_analysis(analysis_simulated_hierar…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> summary_survey_glm              summarize_analysis(analysis_survey_glm)     …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> summary_survey_hierarchical     summarize_analysis(analysis_survey_hierarchi…</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"styler"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="drake_plan_source.html">drake_plan_source</a></span><span class="op">(</span><span class="va">plan</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">drake_plan</span><span style="color: #BBBB00;">(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_simulated_glm = <span style="color: #00BBBB;">analyze_data</span><span style="color: #0000BB;">(</span>data_simulated, <span style="color: #BBBB00;">"glm"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_simulated_hierarchical = <span style="color: #00BBBB;">analyze_data</span><span style="color: #0000BB;">(</span>data_simulated, <span style="color: #BBBB00;">"hierarchical"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_survey_glm = <span style="color: #00BBBB;">analyze_data</span><span style="color: #0000BB;">(</span>data_survey, <span style="color: #BBBB00;">"glm"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_survey_hierarchical = <span style="color: #00BBBB;">analyze_data</span><span style="color: #0000BB;">(</span>data_survey, <span style="color: #BBBB00;">"hierarchical"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data_simulated = <span style="color: #00BBBB;">get_data</span><span style="color: #0000BB;">(</span><span style="color: #BBBB00;">"simulated"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data_survey = <span style="color: #00BBBB;">get_data</span><span style="color: #0000BB;">(</span><span style="color: #BBBB00;">"survey"</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   results_data_simulated = <span style="color: #00BBBB;">bind_rows</span><span style="color: #0000BB;">(</span>summary_simulated_glm, summary_simulated_hierarchical<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   results_data_survey = <span style="color: #00BBBB;">bind_rows</span><span style="color: #0000BB;">(</span>summary_survey_glm, summary_survey_hierarchical<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   summary_simulated_glm = <span style="color: #00BBBB;">summarize_analysis</span><span style="color: #0000BB;">(</span>analysis_simulated_glm<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   summary_simulated_hierarchical = <span style="color: #00BBBB;">summarize_analysis</span><span style="color: #0000BB;">(</span>analysis_simulated_hierarchical<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   summary_survey_glm = <span style="color: #00BBBB;">summarize_analysis</span><span style="color: #0000BB;">(</span>analysis_survey_glm<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   summary_survey_hierarchical = <span style="color: #00BBBB;">summarize_analysis</span><span style="color: #0000BB;">(</span>analysis_survey_hierarchical<span style="color: #0000BB;">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">)</span></span>
<span class="r-in"><span><span class="co"># Static splitting</span></span></span>
<span class="r-in"><span><span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="drake_plan.html">drake_plan</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  analysis <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">analyze</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">split</span><span class="op">(</span><span class="va">data</span>, slices <span class="op">=</span> <span class="fl">3L</span>, margin <span class="op">=</span> <span class="fl">1L</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plan</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target     command                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;expr_lst&gt;</span>                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> analysis_1 analyze(drake_slice(data = data, slices = 3L, index = 1, margin = …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> analysis_2 analyze(drake_slice(data = data, slices = 3L, index = 2, margin = …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> analysis_3 analyze(drake_slice(data = data, slices = 3L, index = 3, margin = …</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"styler"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="drake_plan_source.html">drake_plan_source</a></span><span class="op">(</span><span class="va">plan</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">drake_plan</span><span style="color: #BBBB00;">(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_1 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span><span style="color: #00BBBB;">drake_slice(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = data, slices = <span style="color: #0000BB;">3L</span>, index = <span style="color: #0000BB;">1</span>, margin = <span style="color: #0000BB;">1L</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     drop = <span style="color: #0000BB;">FALSE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #00BBBB;">)</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_2 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span><span style="color: #00BBBB;">drake_slice(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = data, slices = <span style="color: #0000BB;">3L</span>, index = <span style="color: #0000BB;">2</span>, margin = <span style="color: #0000BB;">1L</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     drop = <span style="color: #0000BB;">FALSE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #00BBBB;">)</span><span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_3 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span><span style="color: #00BBBB;">drake_slice(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data = data, slices = <span style="color: #0000BB;">3L</span>, index = <span style="color: #0000BB;">3</span>, margin = <span style="color: #0000BB;">1L</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     drop = <span style="color: #0000BB;">FALSE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #00BBBB;">)</span><span style="color: #0000BB;">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">)</span></span>
<span class="r-in"><span><span class="co"># Static tags:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="drake_plan.html">drake_plan</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">command</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, .tag_in <span class="op">=</span> <span class="va">from</span>, .tag_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">to</span>, <span class="va">out</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  trace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target command    y     x     from  to    out  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;expr_lst&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> x_1    command    1     x_1   x     x_1   x_1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> x_2    command    2     x_2   x     x_2   x_2  </span>
<span class="r-in"><span><span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="drake_plan.html">drake_plan</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  survey <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">survey_data</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, .tag_in <span class="op">=</span> <span class="va">source</span>, .tag_out <span class="op">=</span> <span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  download <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">download_data</span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, .tag_in <span class="op">=</span> <span class="va">source</span>, .tag_out <span class="op">=</span> <span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  analysis <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">analyze</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="target.html">target</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    transform <span class="op">=</span> <span class="fu">combine</span><span class="op">(</span><span class="va">analysis</span>, .by <span class="op">=</span> <span class="va">source</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plan</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    target              command                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;expr_lst&gt;</span>                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> analysis_survey_1   analyze(survey_1)                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> analysis_survey_2   analyze(survey_2)                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> analysis_download_5 analyze(download_5)                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> analysis_download_6 analyze(download_6)                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> download_5          download_data()                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> download_6          download_data()                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> results_download    bind_rows(analysis_download_5, analysis_download_6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> results_survey      bind_rows(analysis_survey_1, analysis_survey_2)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> survey_1            survey_data(1)                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> survey_2            survey_data(2)                                     </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"styler"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="drake_plan_source.html">drake_plan_source</a></span><span class="op">(</span><span class="va">plan</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">drake_plan</span><span style="color: #BBBB00;">(</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_survey_1 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span>survey_1<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_survey_2 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span>survey_2<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_download_5 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span>download_5<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   analysis_download_6 = <span style="color: #00BBBB;">analyze</span><span style="color: #0000BB;">(</span>download_6<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   download_5 = <span style="color: #00BBBB;">download_data</span><span style="color: #0000BB;">()</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   download_6 = <span style="color: #00BBBB;">download_data</span><span style="color: #0000BB;">()</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   results_download = <span style="color: #00BBBB;">bind_rows</span><span style="color: #0000BB;">(</span>analysis_download_5, analysis_download_6<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   results_survey = <span style="color: #00BBBB;">bind_rows</span><span style="color: #0000BB;">(</span>analysis_survey_1, analysis_survey_2<span style="color: #0000BB;">)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   survey_1 = <span style="color: #00BBBB;">survey_data</span><span style="color: #0000BB;">(1)</span>,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   survey_2 = <span style="color: #00BBBB;">survey_data</span><span style="color: #0000BB;">(2)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

